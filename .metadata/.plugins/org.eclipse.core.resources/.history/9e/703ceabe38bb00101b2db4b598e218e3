/*
 * package ai.presight.inventoryservice.security;
 * 
 * import io.jsonwebtoken.*; import io.jsonwebtoken.security.Keys; import
 * org.springframework.stereotype.Component; import java.security.Key; import
 * java.util.*;
 * 
 * @Component public class JwtUtil {
 * 
 * private static final String SECRET_KEY =
 * "mysupersecretkeymysupersecretkeymysupersecretkey";
 * 
 * private Key getSigningKey() { return
 * Keys.hmacShaKeyFor(SECRET_KEY.getBytes()); }
 * 
 * public String generateToken(String username, List<String> roles) { return
 * Jwts.builder() .setSubject(username) .claim("roles", roles) .setIssuedAt(new
 * Date(System.currentTimeMillis())) .setExpiration(new
 * Date(System.currentTimeMillis() + 1000 * 60 * 60)) // 1 hour
 * .signWith(getSigningKey(), SignatureAlgorithm.HS256) .compact(); }
 * 
 * public boolean validateToken(String token) { try {
 * Jwts.parserBuilder().setSigningKey(getSigningKey()).build().parseClaimsJws(
 * token); return true; } catch (JwtException | IllegalArgumentException e) {
 * return false; } }
 * 
 * public String extractUsername(String token) { return Jwts.parserBuilder()
 * .setSigningKey(getSigningKey()) .build() .parseClaimsJws(token) .getBody()
 * .getSubject(); }
 * 
 * public List<String> extractRoles(String token) { Claims claims =
 * Jwts.parserBuilder() .setSigningKey(getSigningKey()) .build()
 * .parseClaimsJws(token) .getBody();
 * 
 * Object rolesObj = claims.get("roles"); if (rolesObj instanceof List<?>) {
 * return ((List<?>) rolesObj).stream() .map(Object::toString) .toList(); }
 * return List.of(); } }
 */